---
import { getCollection, render } from "astro:content";
import Base from "@/layouts/Base.astro";
import PageHeader from "@/layouts/partials/PageHeader.astro";

export async function getStaticPaths() {
  const solutions = await getCollection("solutions");
  return solutions.map((solution) => ({
    params: { slug: solution.id },
    props: { solution },
  }));
}

const { solution } = Astro.props;
const { Content } = await render(solution);
const { title, meta_title, description, image, hero, benefits, features, process, use_cases, stats, cta, testimonial, case_study } = solution.data;
---

<Base title={meta_title || title} description={description} image={image}>
  <!-- Hero Section -->
  {hero && (
    <section class="section">
      <div class="container">
        <div class="row items-center">
          <div class="lg:col-6">
            <span class="mb-4 inline-block font-medium uppercase text-primary">
              {hero.subtitle}
            </span>
            <h1 class="mb-6 text-4xl font-bold lg:text-5xl">
              {hero.title}
            </h1>
            <p class="mb-8 text-lg text-text-light">
              {hero.description}
            </p>
            <div class="flex flex-wrap gap-4">
              {hero.buttons?.map((button) => (
                <a
                  href={button.link}
                  class={`btn ${button.style === 'primary' ? 'btn-primary' : 'btn-outline'}`}
                >
                  {button.label}
                </a>
              ))}
            </div>
          </div>
          {hero.image && (
            <div class="lg:col-6">
              <img src={hero.image} alt={hero.title} class="w-full rounded-lg" />
            </div>
          )}
        </div>
      </div>
    </section>
  )}

  <!-- Benefits Section -->
  {benefits && (
    <section class="section bg-theme-light">
      <div class="container">
        <h2 class="mb-12 text-center text-3xl font-bold">{benefits.title}</h2>
        <div class="row">
          {benefits.items?.map((item) => (
            <div class="md:col-4 mb-8">
              <div class="text-center">
                <img src={item.icon} alt={item.title} class="mx-auto mb-4 h-16 w-16" />
                <h3 class="mb-2 text-xl font-semibold">{item.title}</h3>
                <p class="text-text-light">{item.description}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Features Section -->
  {features && (
    <section class="section">
      <div class="container">
        <div class="mb-12 text-center">
          <h2 class="mb-4 text-3xl font-bold">{features.title}</h2>
          <p class="text-lg text-text-light">{features.description}</p>
        </div>
        <div class="row">
          {features.list?.map((feature) => (
            <div class="lg:col-6 mb-8">
              <div class="flex">
                <img src={feature.icon} alt={feature.title} class="mr-4 h-12 w-12" />
                <div>
                  <h3 class="mb-2 text-xl font-semibold">{feature.title}</h3>
                  <p class="text-text-light">{feature.description}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Process Section -->
  {process && (
    <section class="section bg-theme-light">
      <div class="container">
        <h2 class="mb-12 text-center text-3xl font-bold">{process.title}</h2>
        <div class="row">
          {process.steps?.map((step) => (
            <div class="md:col-4 lg:col-2-4 mb-8">
              <div class="text-center">
                <div class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary text-2xl font-bold text-white">
                  {step.number}
                </div>
                <h3 class="mb-2 text-lg font-semibold">{step.title}</h3>
                <p class="text-sm text-text-light">{step.description}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Stats Section -->
  {stats && (
    <section class="section">
      <div class="container">
        <div class="row">
          {stats.map((stat) => (
            <div class="md:col-3 mb-8">
              <div class="text-center">
                <div class="mb-2 text-4xl font-bold text-primary">{stat.value}</div>
                <div class="text-text-light">{stat.label}</div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Content Section -->
  <section class="section">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-10">
          <div class="content prose max-w-none">
            <Content />
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Testimonial -->
  {testimonial && (
    <section class="section bg-theme-light">
      <div class="container">
        <div class="row justify-center">
          <div class="lg:col-8">
            <div class="text-center">
              <blockquote class="mb-6 text-2xl font-light italic">
                "{testimonial.quote}"
              </blockquote>
              <div class="flex items-center justify-center">
                {testimonial.avatar && (
                  <img src={testimonial.avatar} alt={testimonial.author} class="mr-4 h-12 w-12 rounded-full" />
                )}
                <div class="text-left">
                  <div class="font-semibold">{testimonial.author}</div>
                  <div class="text-sm text-text-light">{testimonial.position}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- CTA Section -->
  {cta && (
    <section class="section">
      <div class="container">
        <div class="rounded-xl bg-gradient-to-r from-primary to-secondary px-8 py-12 text-center text-white">
          <h2 class="mb-4 text-3xl font-bold">{cta.title}</h2>
          <p class="mb-8 text-lg">{cta.description}</p>
          {cta.button && (
            <a href={cta.button.link} class="btn btn-white">
              {cta.button.label}
            </a>
          )}
        </div>
      </div>
    </section>
  )}
</Base>